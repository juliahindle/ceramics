{"ast":null,"code":"var _toConsumableArray = require(\"/Users/juliahindle/Documents/GitHub/ceramics/node_modules/@babel/runtime/helpers/toConsumableArray.js\").default;\n\nvar _regeneratorRuntime = require(\"/Users/juliahindle/Documents/GitHub/ceramics/node_modules/@babel/runtime/helpers/regeneratorRuntime.js\").default;\n\nvar _objectSpread = require(\"/Users/juliahindle/Documents/GitHub/ceramics/node_modules/@babel/runtime/helpers/objectSpread2.js\").default;\n\nvar _asyncToGenerator = require(\"/Users/juliahindle/Documents/GitHub/ceramics/node_modules/@babel/runtime/helpers/asyncToGenerator.js\").default;\n\nvar _classCallCheck = require(\"/Users/juliahindle/Documents/GitHub/ceramics/node_modules/@babel/runtime/helpers/classCallCheck.js\").default;\n\nvar _createClass = require(\"/Users/juliahindle/Documents/GitHub/ceramics/node_modules/@babel/runtime/helpers/createClass.js\").default;\n\nvar _ = require('lodash');\n\nvar GoogleSpreadsheetRow = require('./GoogleSpreadsheetRow');\n\nvar GoogleSpreadsheetCell = require('./GoogleSpreadsheetCell');\n\nvar _require = require('./utils'),\n    getFieldMask = _require.getFieldMask,\n    columnToLetter = _require.columnToLetter,\n    letterToColumn = _require.letterToColumn;\n\nfunction checkForDuplicateHeaders(headers) {\n  // check for duplicate headers\n  var checkForDupes = _.groupBy(headers); // { c1: ['c1'], c2: ['c2', 'c2' ]}\n\n\n  _.each(checkForDupes, function (grouped, header) {\n    if (!header) return; // empty columns are skipped, so multiple is ok\n\n    if (grouped.length > 1) {\n      throw new Error(\"Duplicate header detected: \\\"\".concat(header, \"\\\". Please make sure all non-empty headers are unique\"));\n    }\n  });\n}\n\nvar GoogleSpreadsheetWorksheet = /*#__PURE__*/function () {\n  \"use strict\";\n\n  function GoogleSpreadsheetWorksheet(parentSpreadsheet, _ref) {\n    var properties = _ref.properties,\n        data = _ref.data;\n\n    _classCallCheck(this, GoogleSpreadsheetWorksheet);\n\n    this._spreadsheet = parentSpreadsheet; // the parent GoogleSpreadsheet instance\n\n    this._headerRowIndex = 1; // assume \"header row\" (for row-based calls) is in first row\n    // basic properties\n\n    this._rawProperties = properties;\n    this._cells = []; // we will use a 2d sparse array to store cells;\n\n    this._rowMetadata = []; // 1d sparse array\n\n    this._columnMetadata = [];\n    if (data) this._fillCellData(data);\n    return this;\n  } // INTERNAL UTILITY FUNCTIONS ////////////////////////////////////////////////////////////////////\n\n\n  _createClass(GoogleSpreadsheetWorksheet, [{\n    key: \"_makeSingleUpdateRequest\",\n    value: function () {\n      var _makeSingleUpdateRequest2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(requestType, requestParams) {\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                return _context.abrupt(\"return\", this._spreadsheet._makeSingleUpdateRequest(requestType, _objectSpread({}, requestParams)));\n\n              case 1:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function _makeSingleUpdateRequest(_x, _x2) {\n        return _makeSingleUpdateRequest2.apply(this, arguments);\n      }\n\n      return _makeSingleUpdateRequest;\n    }()\n  }, {\n    key: \"_ensureInfoLoaded\",\n    value: function _ensureInfoLoaded() {\n      if (!this._rawProperties) {\n        throw new Error('You must call `doc.loadInfo()` again before accessing this property');\n      }\n    }\n  }, {\n    key: \"resetLocalCache\",\n    value: function resetLocalCache(dataOnly) {\n      if (!dataOnly) this._rawProperties = null;\n      this.headerValues = null;\n      this._headerRowIndex = 1;\n      this._cells = [];\n    }\n  }, {\n    key: \"_fillCellData\",\n    value: function _fillCellData(dataRanges) {\n      var _this = this;\n\n      _.each(dataRanges, function (range) {\n        var startRow = range.startRow || 0;\n        var startColumn = range.startColumn || 0;\n        var numRows = range.rowMetadata.length;\n        var numColumns = range.columnMetadata.length; // update cell data for entire range\n\n        for (var i = 0; i < numRows; i++) {\n          var actualRow = startRow + i;\n\n          for (var j = 0; j < numColumns; j++) {\n            var actualColumn = startColumn + j; // if the row has not been initialized yet, do it\n\n            if (!_this._cells[actualRow]) _this._cells[actualRow] = []; // see if the response includes some info for the cell\n\n            var cellData = _.get(range, \"rowData[\".concat(i, \"].values[\").concat(j, \"]\")); // update the cell object or create it\n\n\n            if (_this._cells[actualRow][actualColumn]) {\n              _this._cells[actualRow][actualColumn]._updateRawData(cellData);\n            } else {\n              _this._cells[actualRow][actualColumn] = new GoogleSpreadsheetCell(_this, actualRow, actualColumn, cellData);\n            }\n          }\n        } // update row metadata\n\n\n        for (var _i = 0; _i < range.rowMetadata.length; _i++) {\n          _this._rowMetadata[startRow + _i] = range.rowMetadata[_i];\n        } // update column metadata\n\n\n        for (var _i2 = 0; _i2 < range.columnMetadata.length; _i2++) {\n          _this._columnMetadata[startColumn + _i2] = range.columnMetadata[_i2];\n        }\n      });\n    } // PROPERTY GETTERS //////////////////////////////////////////////////////////////////////////////\n\n  }, {\n    key: \"_getProp\",\n    value: function _getProp(param) {\n      this._ensureInfoLoaded();\n\n      return this._rawProperties[param];\n    }\n  }, {\n    key: \"_setProp\",\n    value: function _setProp(param, newVal) {\n      // eslint-disable-line no-unused-vars\n      throw new Error('Do not update directly - use `updateProperties()`');\n    }\n  }, {\n    key: \"sheetId\",\n    get: function get() {\n      return this._getProp('sheetId');\n    },\n    set: function set(newVal) {\n      return this._setProp('sheetId', newVal);\n    }\n  }, {\n    key: \"title\",\n    get: function get() {\n      return this._getProp('title');\n    },\n    set: function set(newVal) {\n      return this._setProp('title', newVal);\n    }\n  }, {\n    key: \"index\",\n    get: function get() {\n      return this._getProp('index');\n    },\n    set: function set(newVal) {\n      return this._setProp('index', newVal);\n    }\n  }, {\n    key: \"sheetType\",\n    get: function get() {\n      return this._getProp('sheetType');\n    },\n    set: function set(newVal) {\n      return this._setProp('sheetType', newVal);\n    }\n  }, {\n    key: \"gridProperties\",\n    get: function get() {\n      return this._getProp('gridProperties');\n    },\n    set: function set(newVal) {\n      return this._setProp('gridProperties', newVal);\n    }\n  }, {\n    key: \"hidden\",\n    get: function get() {\n      return this._getProp('hidden');\n    },\n    set: function set(newVal) {\n      return this._setProp('hidden', newVal);\n    }\n  }, {\n    key: \"tabColor\",\n    get: function get() {\n      return this._getProp('tabColor');\n    },\n    set: function set(newVal) {\n      return this._setProp('tabColor', newVal);\n    }\n  }, {\n    key: \"rightToLeft\",\n    get: function get() {\n      return this._getProp('rightToLeft');\n    },\n    set: function set(newVal) {\n      return this._setProp('rightToLeft', newVal);\n    }\n  }, {\n    key: \"rowCount\",\n    get: function get() {\n      this._ensureInfoLoaded();\n\n      return this.gridProperties.rowCount;\n    },\n    set: function set(newVal) {\n      throw new Error('Do not update directly. Use resize()');\n    }\n  }, {\n    key: \"columnCount\",\n    get: function get() {\n      this._ensureInfoLoaded();\n\n      return this.gridProperties.columnCount;\n    },\n    set: function set(newVal) {\n      throw new Error('Do not update directly. Use resize()');\n    }\n  }, {\n    key: \"colCount\",\n    get: function get() {\n      throw new Error('`colCount` is deprecated - please use `columnCount` instead.');\n    }\n  }, {\n    key: \"a1SheetName\",\n    get: function get() {\n      return \"'\".concat(this.title.replace(/'/g, \"''\"), \"'\");\n    }\n  }, {\n    key: \"encodedA1SheetName\",\n    get: function get() {\n      return encodeURIComponent(this.a1SheetName);\n    }\n  }, {\n    key: \"lastColumnLetter\",\n    get: function get() {\n      return columnToLetter(this.columnCount);\n    } // CELLS-BASED INTERACTIONS //////////////////////////////////////////////////////////////////////\n\n  }, {\n    key: \"cellStats\",\n    get: function get() {\n      var allCells = _.flatten(this._cells);\n\n      allCells = _.compact(allCells);\n      return {\n        nonEmpty: _.filter(allCells, function (c) {\n          return c.value;\n        }).length,\n        loaded: allCells.length,\n        total: this.rowCount * this.columnCount\n      };\n    }\n  }, {\n    key: \"getCellByA1\",\n    value: function getCellByA1(a1Address) {\n      var split = a1Address.match(/([A-Z]+)([0-9]+)/);\n      var columnIndex = letterToColumn(split[1]);\n      var rowIndex = parseInt(split[2]);\n      return this.getCell(rowIndex - 1, columnIndex - 1);\n    }\n  }, {\n    key: \"getCell\",\n    value: function getCell(rowIndex, columnIndex) {\n      if (rowIndex < 0 || columnIndex < 0) throw new Error('Min coordinate is 0, 0');\n\n      if (rowIndex >= this.rowCount || columnIndex >= this.columnCount) {\n        throw new Error(\"Out of bounds, sheet is \".concat(this.rowCount, \" by \").concat(this.columnCount));\n      }\n\n      if (!_.get(this._cells, \"[\".concat(rowIndex, \"][\").concat(columnIndex, \"]\"))) {\n        throw new Error('This cell has not been loaded yet');\n      }\n\n      return this._cells[rowIndex][columnIndex];\n    }\n  }, {\n    key: \"loadCells\",\n    value: function () {\n      var _loadCells = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(sheetFilters) {\n        var _this2 = this;\n\n        var filtersArray;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (sheetFilters) {\n                  _context2.next = 2;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\", this._spreadsheet.loadCells(this.a1SheetName));\n\n              case 2:\n                filtersArray = _.isArray(sheetFilters) ? sheetFilters : [sheetFilters];\n                filtersArray = _.map(filtersArray, function (filter) {\n                  // add sheet name to A1 ranges\n                  if (_.isString(filter)) {\n                    if (filter.startsWith(_this2.a1SheetName)) return filter;\n                    return \"\".concat(_this2.a1SheetName, \"!\").concat(filter);\n                  }\n\n                  if (_.isObject(filter)) {\n                    // TODO: detect and support DeveloperMetadata filters\n                    if (!filter.sheetId) {\n                      return _objectSpread({\n                        sheetId: _this2.sheetId\n                      }, filter);\n                    }\n\n                    if (filter.sheetId !== _this2.sheetId) {\n                      throw new Error('Leave sheet ID blank or set to matching ID of this sheet');\n                    } else {\n                      return filter;\n                    }\n                  } else {\n                    throw new Error('Each filter must be a A1 range string or gridrange object');\n                  }\n                });\n                return _context2.abrupt(\"return\", this._spreadsheet.loadCells(filtersArray));\n\n              case 5:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function loadCells(_x3) {\n        return _loadCells.apply(this, arguments);\n      }\n\n      return loadCells;\n    }()\n  }, {\n    key: \"saveUpdatedCells\",\n    value: function () {\n      var _saveUpdatedCells = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n        var cellsToSave;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                cellsToSave = _.filter(_.flatten(this._cells), {\n                  _isDirty: true\n                });\n\n                if (!cellsToSave.length) {\n                  _context3.next = 4;\n                  break;\n                }\n\n                _context3.next = 4;\n                return this.saveCells(cellsToSave);\n\n              case 4:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function saveUpdatedCells() {\n        return _saveUpdatedCells.apply(this, arguments);\n      }\n\n      return saveUpdatedCells;\n    }()\n  }, {\n    key: \"saveCells\",\n    value: function () {\n      var _saveCells = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(cellsToUpdate) {\n        var _this3 = this;\n\n        var requests, responseRanges;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                // we send an individual \"updateCells\" request for each cell\n                // because the fields that are udpated for each group are the same\n                // and we dont want to accidentally overwrite something\n                requests = _.map(cellsToUpdate, function (cell) {\n                  return cell._getUpdateRequest();\n                });\n                responseRanges = _.map(cellsToUpdate, function (c) {\n                  return \"\".concat(_this3.a1SheetName, \"!\").concat(c.a1Address);\n                }); // if nothing is being updated the request returned is just `null`\n                // so we make sure at least 1 request is valid - otherwise google throws a 400\n\n                if (_.compact(requests).length) {\n                  _context4.next = 4;\n                  break;\n                }\n\n                throw new Error('At least one cell must have something to update');\n\n              case 4:\n                _context4.next = 6;\n                return this._spreadsheet._makeBatchUpdateRequest(requests, responseRanges);\n\n              case 6:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function saveCells(_x4) {\n        return _saveCells.apply(this, arguments);\n      }\n\n      return saveCells;\n    }() // SAVING THIS FOR FUTURE USE\n    // puts the cells that need updating into batches\n    // async updateCellsByBatches() {\n    //   // saving this code, but it's problematic because each group must have the same update fields\n    //   const cellsByRow = _.groupBy(cellsToUpdate, 'rowIndex');\n    //   const groupsToSave = [];\n    //   _.each(cellsByRow, (cells, rowIndex) => {\n    //     let cellGroup = [];\n    //     _.each(cells, (c) => {\n    //       if (!cellGroup.length) {\n    //         cellGroup.push(c);\n    //       } else if (\n    //         cellGroup[cellGroup.length - 1].columnIndex ===\n    //         c.columnIndex - 1\n    //       ) {\n    //         cellGroup.push(c);\n    //       } else {\n    //         groupsToSave.push(cellGroup);\n    //         cellGroup = [];\n    //       }\n    //     });\n    //     groupsToSave.push(cellGroup);\n    //   });\n    //   const requests = _.map(groupsToSave, (cellGroup) => ({\n    //     updateCells: {\n    //       rows: [\n    //         {\n    //           values: _.map(cellGroup, (cell) => ({\n    //             ...cell._draftData.value && {\n    //               userEnteredValue: { [cell._draftData.valueType]: cell._draftData.value },\n    //             },\n    //             ...cell._draftData.note !== undefined && {\n    //               note: cell._draftData.note ,\n    //             },\n    //             ...cell._draftData.userEnteredFormat && {\n    //               userEnteredValue: cell._draftData.userEnteredFormat,\n    //             },\n    //           })),\n    //         },\n    //       ],\n    //       fields: 'userEnteredValue,note,userEnteredFormat',\n    //       start: {\n    //         sheetId: this.sheetId,\n    //         rowIndex: cellGroup[0].rowIndex,\n    //         columnIndex: cellGroup[0].columnIndex,\n    //       },\n    //     },\n    //   }));\n    //   const responseRanges = _.map(groupsToSave, (cellGroup) => {\n    //     let a1Range = cellGroup[0].a1Address;\n    //     if (cellGroup.length > 1)\n    //       a1Range += `:${cellGroup[cellGroup.length - 1].a1Address}`;\n    //     return `${cellGroup[0]._sheet.a1SheetName}!${a1Range}`;\n    //   });\n    // }\n    // ROW BASED FUNCTIONS ///////////////////////////////////////////////////////////////////////////\n\n  }, {\n    key: \"loadHeaderRow\",\n    value: function () {\n      var _loadHeaderRow = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(headerRowIndex) {\n        var rows;\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                if (headerRowIndex !== undefined) this._headerRowIndex = headerRowIndex;\n                _context5.next = 3;\n                return this.getCellsInRange(\"A\".concat(this._headerRowIndex, \":\").concat(this.lastColumnLetter).concat(this._headerRowIndex));\n\n              case 3:\n                rows = _context5.sent;\n\n                if (rows) {\n                  _context5.next = 6;\n                  break;\n                }\n\n                throw new Error('No values in the header row - fill the first row with header values before trying to interact with rows');\n\n              case 6:\n                this.headerValues = _.map(rows[0], function (header) {\n                  return header.trim();\n                });\n\n                if (_.compact(this.headerValues).length) {\n                  _context5.next = 9;\n                  break;\n                }\n\n                throw new Error('All your header cells are blank - fill the first row with header values before trying to interact with rows');\n\n              case 9:\n                checkForDuplicateHeaders(this.headerValues);\n\n              case 10:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function loadHeaderRow(_x5) {\n        return _loadHeaderRow.apply(this, arguments);\n      }\n\n      return loadHeaderRow;\n    }()\n  }, {\n    key: \"setHeaderRow\",\n    value: function () {\n      var _setHeaderRow = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6(headerValues, headerRowIndex) {\n        var trimmedHeaderValues, response;\n        return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                if (headerValues) {\n                  _context6.next = 2;\n                  break;\n                }\n\n                return _context6.abrupt(\"return\");\n\n              case 2:\n                if (!(headerValues.length > this.columnCount)) {\n                  _context6.next = 4;\n                  break;\n                }\n\n                throw new Error(\"Sheet is not large enough to fit \".concat(headerValues.length, \" columns. Resize the sheet first.\"));\n\n              case 4:\n                trimmedHeaderValues = _.map(headerValues, function (h) {\n                  return h.trim();\n                });\n                checkForDuplicateHeaders(trimmedHeaderValues);\n\n                if (_.compact(trimmedHeaderValues).length) {\n                  _context6.next = 8;\n                  break;\n                }\n\n                throw new Error('All your header cells are blank -');\n\n              case 8:\n                if (headerRowIndex) this._headerRowIndex = headerRowIndex;\n                _context6.next = 11;\n                return this._spreadsheet.axios.request({\n                  method: 'put',\n                  url: \"/values/\".concat(this.encodedA1SheetName, \"!\").concat(this._headerRowIndex, \":\").concat(this._headerRowIndex),\n                  params: {\n                    valueInputOption: 'USER_ENTERED',\n                    // other option is RAW\n                    includeValuesInResponse: true\n                  },\n                  data: {\n                    range: \"\".concat(this.a1SheetName, \"!\").concat(this._headerRowIndex, \":\").concat(this._headerRowIndex),\n                    majorDimension: 'ROWS',\n                    values: [[].concat(_toConsumableArray(trimmedHeaderValues), _toConsumableArray(_.times(this.columnCount - trimmedHeaderValues.length, function () {\n                      return '';\n                    })))]\n                  }\n                });\n\n              case 11:\n                response = _context6.sent;\n                this.headerValues = response.data.updatedData.values[0];\n\n              case 13:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function setHeaderRow(_x6, _x7) {\n        return _setHeaderRow.apply(this, arguments);\n      }\n\n      return setHeaderRow;\n    }()\n  }, {\n    key: \"addRows\",\n    value: function () {\n      var _addRows = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7(rows) {\n        var _this4 = this;\n\n        var options,\n            rowsAsArrays,\n            response,\n            updatedRange,\n            rowNumber,\n            _args7 = arguments;\n        return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                options = _args7.length > 1 && _args7[1] !== undefined ? _args7[1] : {};\n\n                if (!this.title.includes(':')) {\n                  _context7.next = 3;\n                  break;\n                }\n\n                throw new Error('Please remove the \":\" from your sheet title. There is a bug with the google API which breaks appending rows if any colons are in the sheet title.');\n\n              case 3:\n                if (_.isArray(rows)) {\n                  _context7.next = 5;\n                  break;\n                }\n\n                throw new Error('You must pass in an array of row values to append');\n\n              case 5:\n                if (this.headerValues) {\n                  _context7.next = 8;\n                  break;\n                }\n\n                _context7.next = 8;\n                return this.loadHeaderRow();\n\n              case 8:\n                // convert each row into an array of cell values rather than the key/value object\n                rowsAsArrays = [];\n\n                _.each(rows, function (row) {\n                  var rowAsArray;\n\n                  if (_.isArray(row)) {\n                    rowAsArray = row;\n                  } else if (_.isObject(row)) {\n                    rowAsArray = [];\n\n                    for (var i = 0; i < _this4.headerValues.length; i++) {\n                      var propName = _this4.headerValues[i];\n                      rowAsArray[i] = row[propName];\n                    }\n                  } else {\n                    throw new Error('Each row must be an object or an array');\n                  }\n\n                  rowsAsArrays.push(rowAsArray);\n                });\n\n                _context7.next = 12;\n                return this._spreadsheet.axios.request({\n                  method: 'post',\n                  url: \"/values/\".concat(this.encodedA1SheetName, \"!A\").concat(this._headerRowIndex, \":append\"),\n                  params: {\n                    valueInputOption: options.raw ? 'RAW' : 'USER_ENTERED',\n                    insertDataOption: options.insert ? 'INSERT_ROWS' : 'OVERWRITE',\n                    includeValuesInResponse: true\n                  },\n                  data: {\n                    values: rowsAsArrays\n                  }\n                });\n\n              case 12:\n                response = _context7.sent;\n                // extract the new row number from the A1-notation data range in the response\n                // ex: in \"'Sheet8!A2:C2\" -- we want the `2`\n                updatedRange = response.data.updates.updatedRange;\n                rowNumber = updatedRange.match(/![A-Z]+([0-9]+):?/)[1];\n                rowNumber = parseInt(rowNumber); // if new rows were added, we need update sheet.rowRount\n\n                if (options.insert) {\n                  this._rawProperties.gridProperties.rowCount += rows.length;\n                } else if (rowNumber + rows.length > this.rowCount) {\n                  // have to subtract 1 since one row was inserted at rowNumber\n                  this._rawProperties.gridProperties.rowCount = rowNumber + rows.length - 1;\n                }\n\n                return _context7.abrupt(\"return\", _.map(response.data.updates.updatedData.values, function (rowValues) {\n                  var row = new GoogleSpreadsheetRow(_this4, rowNumber++, rowValues);\n                  return row;\n                }));\n\n              case 18:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this);\n      }));\n\n      function addRows(_x8) {\n        return _addRows.apply(this, arguments);\n      }\n\n      return addRows;\n    }()\n  }, {\n    key: \"addRow\",\n    value: function () {\n      var _addRow = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee8(rowValues, options) {\n        var rows;\n        return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                _context8.next = 2;\n                return this.addRows([rowValues], options);\n\n              case 2:\n                rows = _context8.sent;\n                return _context8.abrupt(\"return\", rows[0]);\n\n              case 4:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8, this);\n      }));\n\n      function addRow(_x9, _x10) {\n        return _addRow.apply(this, arguments);\n      }\n\n      return addRow;\n    }()\n  }, {\n    key: \"getRows\",\n    value: function () {\n      var _getRows = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee9() {\n        var options,\n            firstRow,\n            lastRow,\n            lastColumn,\n            rawRows,\n            rows,\n            rowNum,\n            i,\n            _args9 = arguments;\n        return _regeneratorRuntime().wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                options = _args9.length > 0 && _args9[0] !== undefined ? _args9[0] : {};\n                // https://developers.google.com/sheets/api/guides/migration\n                // v4 API does not have equivalents for the row-order query parameters provided\n                // Reverse-order is trivial; simply process the returned values array in reverse order.\n                // Order by column is not supported for reads, but it is possible to sort the data then read\n                // v4 API does not currently have a direct equivalent for the Sheets API v3 structured queries\n                // However, you can retrieve the relevant data and sort through it as needed in your application\n                // options\n                // - offset\n                // - limit\n                options.offset = options.offset || 0;\n                options.limit = options.limit || this.rowCount - 1;\n\n                if (this.headerValues) {\n                  _context9.next = 6;\n                  break;\n                }\n\n                _context9.next = 6;\n                return this.loadHeaderRow();\n\n              case 6:\n                firstRow = 1 + this._headerRowIndex + options.offset;\n                lastRow = firstRow + options.limit - 1; // inclusive so we subtract 1\n\n                lastColumn = columnToLetter(this.headerValues.length);\n                _context9.next = 11;\n                return this.getCellsInRange(\"A\".concat(firstRow, \":\").concat(lastColumn).concat(lastRow));\n\n              case 11:\n                rawRows = _context9.sent;\n\n                if (rawRows) {\n                  _context9.next = 14;\n                  break;\n                }\n\n                return _context9.abrupt(\"return\", []);\n\n              case 14:\n                rows = [];\n                rowNum = firstRow;\n\n                for (i = 0; i < rawRows.length; i++) {\n                  rows.push(new GoogleSpreadsheetRow(this, rowNum++, rawRows[i]));\n                }\n\n                return _context9.abrupt(\"return\", rows);\n\n              case 18:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9, this);\n      }));\n\n      function getRows() {\n        return _getRows.apply(this, arguments);\n      }\n\n      return getRows;\n    }()\n  }, {\n    key: \"clearRows\",\n    value: function () {\n      var _clearRows = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee10() {\n        var options,\n            startRowIndex,\n            endRowIndex,\n            _args10 = arguments;\n        return _regeneratorRuntime().wrap(function _callee10$(_context10) {\n          while (1) {\n            switch (_context10.prev = _context10.next) {\n              case 0:\n                options = _args10.length > 0 && _args10[0] !== undefined ? _args10[0] : {};\n                // default to first row after header\n                startRowIndex = options.start || this._headerRowIndex + 1;\n                endRowIndex = options.end || this.rowCount;\n                _context10.next = 5;\n                return this._spreadsheet.axios.post(\"/values/\".concat(this.encodedA1SheetName, \"!\").concat(startRowIndex, \":\").concat(endRowIndex, \":clear\"));\n\n              case 5:\n              case \"end\":\n                return _context10.stop();\n            }\n          }\n        }, _callee10, this);\n      }));\n\n      function clearRows() {\n        return _clearRows.apply(this, arguments);\n      }\n\n      return clearRows;\n    }() // BASIC PROPS ///////////////////////////////////////////////////////////////////////////////////\n\n  }, {\n    key: \"updateProperties\",\n    value: function () {\n      var _updateProperties = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee11(properties) {\n        return _regeneratorRuntime().wrap(function _callee11$(_context11) {\n          while (1) {\n            switch (_context11.prev = _context11.next) {\n              case 0:\n                return _context11.abrupt(\"return\", this._makeSingleUpdateRequest('updateSheetProperties', {\n                  properties: _objectSpread({\n                    sheetId: this.sheetId\n                  }, properties),\n                  fields: getFieldMask(properties)\n                }));\n\n              case 1:\n              case \"end\":\n                return _context11.stop();\n            }\n          }\n        }, _callee11, this);\n      }));\n\n      function updateProperties(_x11) {\n        return _updateProperties.apply(this, arguments);\n      }\n\n      return updateProperties;\n    }()\n  }, {\n    key: \"updateGridProperties\",\n    value: function () {\n      var _updateGridProperties = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee12(gridProperties) {\n        return _regeneratorRuntime().wrap(function _callee12$(_context12) {\n          while (1) {\n            switch (_context12.prev = _context12.next) {\n              case 0:\n                return _context12.abrupt(\"return\", this.updateProperties({\n                  gridProperties: gridProperties\n                }));\n\n              case 1:\n              case \"end\":\n                return _context12.stop();\n            }\n          }\n        }, _callee12, this);\n      }));\n\n      function updateGridProperties(_x12) {\n        return _updateGridProperties.apply(this, arguments);\n      }\n\n      return updateGridProperties;\n    }() // just a shortcut because resize makes more sense to change rowCount / columnCount\n\n  }, {\n    key: \"resize\",\n    value: function () {\n      var _resize = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee13(gridProperties) {\n        return _regeneratorRuntime().wrap(function _callee13$(_context13) {\n          while (1) {\n            switch (_context13.prev = _context13.next) {\n              case 0:\n                return _context13.abrupt(\"return\", this.updateGridProperties(gridProperties));\n\n              case 1:\n              case \"end\":\n                return _context13.stop();\n            }\n          }\n        }, _callee13, this);\n      }));\n\n      function resize(_x13) {\n        return _resize.apply(this, arguments);\n      }\n\n      return resize;\n    }()\n  }, {\n    key: \"updateDimensionProperties\",\n    value: function () {\n      var _updateDimensionProperties = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee14(columnsOrRows, properties, bounds) {\n        return _regeneratorRuntime().wrap(function _callee14$(_context14) {\n          while (1) {\n            switch (_context14.prev = _context14.next) {\n              case 0:\n                return _context14.abrupt(\"return\", this._makeSingleUpdateRequest('updateDimensionProperties', {\n                  range: _objectSpread({\n                    sheetId: this.sheetId,\n                    dimension: columnsOrRows\n                  }, bounds && {\n                    startIndex: bounds.startIndex,\n                    endIndex: bounds.endIndex\n                  }),\n                  properties: properties,\n                  fields: getFieldMask(properties)\n                }));\n\n              case 1:\n              case \"end\":\n                return _context14.stop();\n            }\n          }\n        }, _callee14, this);\n      }));\n\n      function updateDimensionProperties(_x14, _x15, _x16) {\n        return _updateDimensionProperties.apply(this, arguments);\n      }\n\n      return updateDimensionProperties;\n    }() // OTHER /////////////////////////////////////////////////////////////////////////////////////////\n    // this uses the \"values\" getter and does not give all the info about the cell contents\n    // it is used internally when loading header cells\n\n  }, {\n    key: \"getCellsInRange\",\n    value: function () {\n      var _getCellsInRange = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee15(a1Range, options) {\n        var response;\n        return _regeneratorRuntime().wrap(function _callee15$(_context15) {\n          while (1) {\n            switch (_context15.prev = _context15.next) {\n              case 0:\n                _context15.next = 2;\n                return this._spreadsheet.axios.get(\"/values/\".concat(this.encodedA1SheetName, \"!\").concat(a1Range), {\n                  params: options\n                });\n\n              case 2:\n                response = _context15.sent;\n                return _context15.abrupt(\"return\", response.data.values);\n\n              case 4:\n              case \"end\":\n                return _context15.stop();\n            }\n          }\n        }, _callee15, this);\n      }));\n\n      function getCellsInRange(_x17, _x18) {\n        return _getCellsInRange.apply(this, arguments);\n      }\n\n      return getCellsInRange;\n    }()\n  }, {\n    key: \"updateNamedRange\",\n    value: function () {\n      var _updateNamedRange = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee16() {\n        return _regeneratorRuntime().wrap(function _callee16$(_context16) {\n          while (1) {\n            switch (_context16.prev = _context16.next) {\n              case 0:\n              case \"end\":\n                return _context16.stop();\n            }\n          }\n        }, _callee16);\n      }));\n\n      function updateNamedRange() {\n        return _updateNamedRange.apply(this, arguments);\n      }\n\n      return updateNamedRange;\n    }()\n  }, {\n    key: \"addNamedRange\",\n    value: function () {\n      var _addNamedRange = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee17() {\n        return _regeneratorRuntime().wrap(function _callee17$(_context17) {\n          while (1) {\n            switch (_context17.prev = _context17.next) {\n              case 0:\n              case \"end\":\n                return _context17.stop();\n            }\n          }\n        }, _callee17);\n      }));\n\n      function addNamedRange() {\n        return _addNamedRange.apply(this, arguments);\n      }\n\n      return addNamedRange;\n    }()\n  }, {\n    key: \"deleteNamedRange\",\n    value: function () {\n      var _deleteNamedRange = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee18() {\n        return _regeneratorRuntime().wrap(function _callee18$(_context18) {\n          while (1) {\n            switch (_context18.prev = _context18.next) {\n              case 0:\n              case \"end\":\n                return _context18.stop();\n            }\n          }\n        }, _callee18);\n      }));\n\n      function deleteNamedRange() {\n        return _deleteNamedRange.apply(this, arguments);\n      }\n\n      return deleteNamedRange;\n    }()\n  }, {\n    key: \"repeatCell\",\n    value: function () {\n      var _repeatCell = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee19() {\n        return _regeneratorRuntime().wrap(function _callee19$(_context19) {\n          while (1) {\n            switch (_context19.prev = _context19.next) {\n              case 0:\n              case \"end\":\n                return _context19.stop();\n            }\n          }\n        }, _callee19);\n      }));\n\n      function repeatCell() {\n        return _repeatCell.apply(this, arguments);\n      }\n\n      return repeatCell;\n    }()\n  }, {\n    key: \"autoFill\",\n    value: function () {\n      var _autoFill = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee20() {\n        return _regeneratorRuntime().wrap(function _callee20$(_context20) {\n          while (1) {\n            switch (_context20.prev = _context20.next) {\n              case 0:\n              case \"end\":\n                return _context20.stop();\n            }\n          }\n        }, _callee20);\n      }));\n\n      function autoFill() {\n        return _autoFill.apply(this, arguments);\n      }\n\n      return autoFill;\n    }()\n  }, {\n    key: \"cutPaste\",\n    value: function () {\n      var _cutPaste = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee21() {\n        return _regeneratorRuntime().wrap(function _callee21$(_context21) {\n          while (1) {\n            switch (_context21.prev = _context21.next) {\n              case 0:\n              case \"end\":\n                return _context21.stop();\n            }\n          }\n        }, _callee21);\n      }));\n\n      function cutPaste() {\n        return _cutPaste.apply(this, arguments);\n      }\n\n      return cutPaste;\n    }()\n  }, {\n    key: \"copyPaste\",\n    value: function () {\n      var _copyPaste = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee22() {\n        return _regeneratorRuntime().wrap(function _callee22$(_context22) {\n          while (1) {\n            switch (_context22.prev = _context22.next) {\n              case 0:\n              case \"end\":\n                return _context22.stop();\n            }\n          }\n        }, _callee22);\n      }));\n\n      function copyPaste() {\n        return _copyPaste.apply(this, arguments);\n      }\n\n      return copyPaste;\n    }()\n  }, {\n    key: \"mergeCells\",\n    value: function () {\n      var _mergeCells = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee23(range) {\n        var mergeType,\n            _args23 = arguments;\n        return _regeneratorRuntime().wrap(function _callee23$(_context23) {\n          while (1) {\n            switch (_context23.prev = _context23.next) {\n              case 0:\n                mergeType = _args23.length > 1 && _args23[1] !== undefined ? _args23[1] : 'MERGE_ALL';\n\n                if (!(range.sheetId && range.sheetId !== this.sheetId)) {\n                  _context23.next = 3;\n                  break;\n                }\n\n                throw new Error('Leave sheet ID blank or set to matching ID of this sheet');\n\n              case 3:\n                _context23.next = 5;\n                return this._makeSingleUpdateRequest('mergeCells', {\n                  mergeType: mergeType,\n                  range: _objectSpread(_objectSpread({}, range), {}, {\n                    sheetId: this.sheetId\n                  })\n                });\n\n              case 5:\n              case \"end\":\n                return _context23.stop();\n            }\n          }\n        }, _callee23, this);\n      }));\n\n      function mergeCells(_x19) {\n        return _mergeCells.apply(this, arguments);\n      }\n\n      return mergeCells;\n    }()\n  }, {\n    key: \"unmergeCells\",\n    value: function () {\n      var _unmergeCells = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee24(range) {\n        return _regeneratorRuntime().wrap(function _callee24$(_context24) {\n          while (1) {\n            switch (_context24.prev = _context24.next) {\n              case 0:\n                if (!(range.sheetId && range.sheetId !== this.sheetId)) {\n                  _context24.next = 2;\n                  break;\n                }\n\n                throw new Error('Leave sheet ID blank or set to matching ID of this sheet');\n\n              case 2:\n                _context24.next = 4;\n                return this._makeSingleUpdateRequest('unmergeCells', {\n                  range: _objectSpread(_objectSpread({}, range), {}, {\n                    sheetId: this.sheetId\n                  })\n                });\n\n              case 4:\n              case \"end\":\n                return _context24.stop();\n            }\n          }\n        }, _callee24, this);\n      }));\n\n      function unmergeCells(_x20) {\n        return _unmergeCells.apply(this, arguments);\n      }\n\n      return unmergeCells;\n    }()\n  }, {\n    key: \"updateBorders\",\n    value: function () {\n      var _updateBorders = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee25() {\n        return _regeneratorRuntime().wrap(function _callee25$(_context25) {\n          while (1) {\n            switch (_context25.prev = _context25.next) {\n              case 0:\n              case \"end\":\n                return _context25.stop();\n            }\n          }\n        }, _callee25);\n      }));\n\n      function updateBorders() {\n        return _updateBorders.apply(this, arguments);\n      }\n\n      return updateBorders;\n    }()\n  }, {\n    key: \"addFilterView\",\n    value: function () {\n      var _addFilterView = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee26() {\n        return _regeneratorRuntime().wrap(function _callee26$(_context26) {\n          while (1) {\n            switch (_context26.prev = _context26.next) {\n              case 0:\n              case \"end\":\n                return _context26.stop();\n            }\n          }\n        }, _callee26);\n      }));\n\n      function addFilterView() {\n        return _addFilterView.apply(this, arguments);\n      }\n\n      return addFilterView;\n    }()\n  }, {\n    key: \"appendCells\",\n    value: function () {\n      var _appendCells = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee27() {\n        return _regeneratorRuntime().wrap(function _callee27$(_context27) {\n          while (1) {\n            switch (_context27.prev = _context27.next) {\n              case 0:\n              case \"end\":\n                return _context27.stop();\n            }\n          }\n        }, _callee27);\n      }));\n\n      function appendCells() {\n        return _appendCells.apply(this, arguments);\n      }\n\n      return appendCells;\n    }()\n  }, {\n    key: \"clearBasicFilter\",\n    value: function () {\n      var _clearBasicFilter = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee28() {\n        return _regeneratorRuntime().wrap(function _callee28$(_context28) {\n          while (1) {\n            switch (_context28.prev = _context28.next) {\n              case 0:\n              case \"end\":\n                return _context28.stop();\n            }\n          }\n        }, _callee28);\n      }));\n\n      function clearBasicFilter() {\n        return _clearBasicFilter.apply(this, arguments);\n      }\n\n      return clearBasicFilter;\n    }()\n  }, {\n    key: \"deleteDimension\",\n    value: function () {\n      var _deleteDimension = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee29() {\n        return _regeneratorRuntime().wrap(function _callee29$(_context29) {\n          while (1) {\n            switch (_context29.prev = _context29.next) {\n              case 0:\n              case \"end\":\n                return _context29.stop();\n            }\n          }\n        }, _callee29);\n      }));\n\n      function deleteDimension() {\n        return _deleteDimension.apply(this, arguments);\n      }\n\n      return deleteDimension;\n    }()\n  }, {\n    key: \"deleteEmbeddedObject\",\n    value: function () {\n      var _deleteEmbeddedObject = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee30() {\n        return _regeneratorRuntime().wrap(function _callee30$(_context30) {\n          while (1) {\n            switch (_context30.prev = _context30.next) {\n              case 0:\n              case \"end\":\n                return _context30.stop();\n            }\n          }\n        }, _callee30);\n      }));\n\n      function deleteEmbeddedObject() {\n        return _deleteEmbeddedObject.apply(this, arguments);\n      }\n\n      return deleteEmbeddedObject;\n    }()\n  }, {\n    key: \"deleteFilterView\",\n    value: function () {\n      var _deleteFilterView = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee31() {\n        return _regeneratorRuntime().wrap(function _callee31$(_context31) {\n          while (1) {\n            switch (_context31.prev = _context31.next) {\n              case 0:\n              case \"end\":\n                return _context31.stop();\n            }\n          }\n        }, _callee31);\n      }));\n\n      function deleteFilterView() {\n        return _deleteFilterView.apply(this, arguments);\n      }\n\n      return deleteFilterView;\n    }()\n  }, {\n    key: \"duplicateFilterView\",\n    value: function () {\n      var _duplicateFilterView = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee32() {\n        return _regeneratorRuntime().wrap(function _callee32$(_context32) {\n          while (1) {\n            switch (_context32.prev = _context32.next) {\n              case 0:\n              case \"end\":\n                return _context32.stop();\n            }\n          }\n        }, _callee32);\n      }));\n\n      function duplicateFilterView() {\n        return _duplicateFilterView.apply(this, arguments);\n      }\n\n      return duplicateFilterView;\n    }()\n  }, {\n    key: \"duplicate\",\n    value: function () {\n      var _duplicate = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee33() {\n        var options,\n            response,\n            newSheetId,\n            _args33 = arguments;\n        return _regeneratorRuntime().wrap(function _callee33$(_context33) {\n          while (1) {\n            switch (_context33.prev = _context33.next) {\n              case 0:\n                options = _args33.length > 0 && _args33[0] !== undefined ? _args33[0] : {};\n                _context33.next = 3;\n                return this._makeSingleUpdateRequest('duplicateSheet', _objectSpread(_objectSpread(_objectSpread({\n                  sourceSheetId: this.sheetId\n                }, options.index !== undefined && {\n                  insertSheetIndex: options.index\n                }), options.id && {\n                  newSheetId: options.id\n                }), options.title && {\n                  newSheetName: options.title\n                }));\n\n              case 3:\n                response = _context33.sent;\n                newSheetId = response.properties.sheetId;\n                return _context33.abrupt(\"return\", this._spreadsheet.sheetsById[newSheetId]);\n\n              case 6:\n              case \"end\":\n                return _context33.stop();\n            }\n          }\n        }, _callee33, this);\n      }));\n\n      function duplicate() {\n        return _duplicate.apply(this, arguments);\n      }\n\n      return duplicate;\n    }()\n  }, {\n    key: \"findReplace\",\n    value: function () {\n      var _findReplace = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee34() {\n        return _regeneratorRuntime().wrap(function _callee34$(_context34) {\n          while (1) {\n            switch (_context34.prev = _context34.next) {\n              case 0:\n              case \"end\":\n                return _context34.stop();\n            }\n          }\n        }, _callee34);\n      }));\n\n      function findReplace() {\n        return _findReplace.apply(this, arguments);\n      }\n\n      return findReplace;\n    }()\n  }, {\n    key: \"insertDimension\",\n    value: function () {\n      var _insertDimension = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee35(columnsOrRows, range) {\n        var inheritFromBefore,\n            _args35 = arguments;\n        return _regeneratorRuntime().wrap(function _callee35$(_context35) {\n          while (1) {\n            switch (_context35.prev = _context35.next) {\n              case 0:\n                inheritFromBefore = _args35.length > 2 && _args35[2] !== undefined ? _args35[2] : null;\n\n                if (columnsOrRows) {\n                  _context35.next = 3;\n                  break;\n                }\n\n                throw new Error('You need to specify a dimension. i.e. COLUMNS|ROWS');\n\n              case 3:\n                if (_.isObject(range)) {\n                  _context35.next = 5;\n                  break;\n                }\n\n                throw new Error('`range` must be an object containing `startIndex` and `endIndex`');\n\n              case 5:\n                if (!(!_.isInteger(range.startIndex) || range.startIndex < 0)) {\n                  _context35.next = 7;\n                  break;\n                }\n\n                throw new Error('range.startIndex must be an integer >=0');\n\n              case 7:\n                if (!(!_.isInteger(range.endIndex) || range.endIndex < 0)) {\n                  _context35.next = 9;\n                  break;\n                }\n\n                throw new Error('range.endIndex must be an integer >=0');\n\n              case 9:\n                if (!(range.endIndex <= range.startIndex)) {\n                  _context35.next = 11;\n                  break;\n                }\n\n                throw new Error('range.endIndex must be greater than range.startIndex');\n\n              case 11:\n                // default inheritFromBefore to true - unless inserting in the first row/column\n                if (inheritFromBefore === null) {\n                  inheritFromBefore = range.startIndex > 0;\n                } // do not allow inheritFromBefore if inserting at first row/column\n\n\n                if (!(inheritFromBefore && range.startIndex === 0)) {\n                  _context35.next = 14;\n                  break;\n                }\n\n                throw new Error('Cannot set inheritFromBefore to true if inserting in first row/column');\n\n              case 14:\n                return _context35.abrupt(\"return\", this._makeSingleUpdateRequest('insertDimension', {\n                  range: {\n                    sheetId: this.sheetId,\n                    dimension: columnsOrRows,\n                    startIndex: range.startIndex,\n                    endIndex: range.endIndex\n                  },\n                  inheritFromBefore: inheritFromBefore\n                }));\n\n              case 15:\n              case \"end\":\n                return _context35.stop();\n            }\n          }\n        }, _callee35, this);\n      }));\n\n      function insertDimension(_x21, _x22) {\n        return _insertDimension.apply(this, arguments);\n      }\n\n      return insertDimension;\n    }()\n  }, {\n    key: \"insertRange\",\n    value: function () {\n      var _insertRange = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee36() {\n        return _regeneratorRuntime().wrap(function _callee36$(_context36) {\n          while (1) {\n            switch (_context36.prev = _context36.next) {\n              case 0:\n              case \"end\":\n                return _context36.stop();\n            }\n          }\n        }, _callee36);\n      }));\n\n      function insertRange() {\n        return _insertRange.apply(this, arguments);\n      }\n\n      return insertRange;\n    }()\n  }, {\n    key: \"moveDimension\",\n    value: function () {\n      var _moveDimension = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee37() {\n        return _regeneratorRuntime().wrap(function _callee37$(_context37) {\n          while (1) {\n            switch (_context37.prev = _context37.next) {\n              case 0:\n              case \"end\":\n                return _context37.stop();\n            }\n          }\n        }, _callee37);\n      }));\n\n      function moveDimension() {\n        return _moveDimension.apply(this, arguments);\n      }\n\n      return moveDimension;\n    }()\n  }, {\n    key: \"updateEmbeddedObjectPosition\",\n    value: function () {\n      var _updateEmbeddedObjectPosition = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee38() {\n        return _regeneratorRuntime().wrap(function _callee38$(_context38) {\n          while (1) {\n            switch (_context38.prev = _context38.next) {\n              case 0:\n              case \"end\":\n                return _context38.stop();\n            }\n          }\n        }, _callee38);\n      }));\n\n      function updateEmbeddedObjectPosition() {\n        return _updateEmbeddedObjectPosition.apply(this, arguments);\n      }\n\n      return updateEmbeddedObjectPosition;\n    }()\n  }, {\n    key: \"pasteData\",\n    value: function () {\n      var _pasteData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee39() {\n        return _regeneratorRuntime().wrap(function _callee39$(_context39) {\n          while (1) {\n            switch (_context39.prev = _context39.next) {\n              case 0:\n              case \"end\":\n                return _context39.stop();\n            }\n          }\n        }, _callee39);\n      }));\n\n      function pasteData() {\n        return _pasteData.apply(this, arguments);\n      }\n\n      return pasteData;\n    }()\n  }, {\n    key: \"textToColumns\",\n    value: function () {\n      var _textToColumns = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee40() {\n        return _regeneratorRuntime().wrap(function _callee40$(_context40) {\n          while (1) {\n            switch (_context40.prev = _context40.next) {\n              case 0:\n              case \"end\":\n                return _context40.stop();\n            }\n          }\n        }, _callee40);\n      }));\n\n      function textToColumns() {\n        return _textToColumns.apply(this, arguments);\n      }\n\n      return textToColumns;\n    }()\n  }, {\n    key: \"updateFilterView\",\n    value: function () {\n      var _updateFilterView = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee41() {\n        return _regeneratorRuntime().wrap(function _callee41$(_context41) {\n          while (1) {\n            switch (_context41.prev = _context41.next) {\n              case 0:\n              case \"end\":\n                return _context41.stop();\n            }\n          }\n        }, _callee41);\n      }));\n\n      function updateFilterView() {\n        return _updateFilterView.apply(this, arguments);\n      }\n\n      return updateFilterView;\n    }()\n  }, {\n    key: \"deleteRange\",\n    value: function () {\n      var _deleteRange = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee42() {\n        return _regeneratorRuntime().wrap(function _callee42$(_context42) {\n          while (1) {\n            switch (_context42.prev = _context42.next) {\n              case 0:\n              case \"end\":\n                return _context42.stop();\n            }\n          }\n        }, _callee42);\n      }));\n\n      function deleteRange() {\n        return _deleteRange.apply(this, arguments);\n      }\n\n      return deleteRange;\n    }()\n  }, {\n    key: \"appendDimension\",\n    value: function () {\n      var _appendDimension = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee43() {\n        return _regeneratorRuntime().wrap(function _callee43$(_context43) {\n          while (1) {\n            switch (_context43.prev = _context43.next) {\n              case 0:\n              case \"end\":\n                return _context43.stop();\n            }\n          }\n        }, _callee43);\n      }));\n\n      function appendDimension() {\n        return _appendDimension.apply(this, arguments);\n      }\n\n      return appendDimension;\n    }()\n  }, {\n    key: \"addConditionalFormatRule\",\n    value: function () {\n      var _addConditionalFormatRule = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee44() {\n        return _regeneratorRuntime().wrap(function _callee44$(_context44) {\n          while (1) {\n            switch (_context44.prev = _context44.next) {\n              case 0:\n              case \"end\":\n                return _context44.stop();\n            }\n          }\n        }, _callee44);\n      }));\n\n      function addConditionalFormatRule() {\n        return _addConditionalFormatRule.apply(this, arguments);\n      }\n\n      return addConditionalFormatRule;\n    }()\n  }, {\n    key: \"updateConditionalFormatRule\",\n    value: function () {\n      var _updateConditionalFormatRule = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee45() {\n        return _regeneratorRuntime().wrap(function _callee45$(_context45) {\n          while (1) {\n            switch (_context45.prev = _context45.next) {\n              case 0:\n              case \"end\":\n                return _context45.stop();\n            }\n          }\n        }, _callee45);\n      }));\n\n      function updateConditionalFormatRule() {\n        return _updateConditionalFormatRule.apply(this, arguments);\n      }\n\n      return updateConditionalFormatRule;\n    }()\n  }, {\n    key: \"deleteConditionalFormatRule\",\n    value: function () {\n      var _deleteConditionalFormatRule = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee46() {\n        return _regeneratorRuntime().wrap(function _callee46$(_context46) {\n          while (1) {\n            switch (_context46.prev = _context46.next) {\n              case 0:\n              case \"end\":\n                return _context46.stop();\n            }\n          }\n        }, _callee46);\n      }));\n\n      function deleteConditionalFormatRule() {\n        return _deleteConditionalFormatRule.apply(this, arguments);\n      }\n\n      return deleteConditionalFormatRule;\n    }()\n  }, {\n    key: \"sortRange\",\n    value: function () {\n      var _sortRange = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee47() {\n        return _regeneratorRuntime().wrap(function _callee47$(_context47) {\n          while (1) {\n            switch (_context47.prev = _context47.next) {\n              case 0:\n              case \"end\":\n                return _context47.stop();\n            }\n          }\n        }, _callee47);\n      }));\n\n      function sortRange() {\n        return _sortRange.apply(this, arguments);\n      }\n\n      return sortRange;\n    }()\n  }, {\n    key: \"setDataValidation\",\n    value: function () {\n      var _setDataValidation = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee48() {\n        return _regeneratorRuntime().wrap(function _callee48$(_context48) {\n          while (1) {\n            switch (_context48.prev = _context48.next) {\n              case 0:\n              case \"end\":\n                return _context48.stop();\n            }\n          }\n        }, _callee48);\n      }));\n\n      function setDataValidation() {\n        return _setDataValidation.apply(this, arguments);\n      }\n\n      return setDataValidation;\n    }()\n  }, {\n    key: \"setBasicFilter\",\n    value: function () {\n      var _setBasicFilter = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee49() {\n        return _regeneratorRuntime().wrap(function _callee49$(_context49) {\n          while (1) {\n            switch (_context49.prev = _context49.next) {\n              case 0:\n              case \"end\":\n                return _context49.stop();\n            }\n          }\n        }, _callee49);\n      }));\n\n      function setBasicFilter() {\n        return _setBasicFilter.apply(this, arguments);\n      }\n\n      return setBasicFilter;\n    }()\n  }, {\n    key: \"addProtectedRange\",\n    value: function () {\n      var _addProtectedRange = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee50() {\n        return _regeneratorRuntime().wrap(function _callee50$(_context50) {\n          while (1) {\n            switch (_context50.prev = _context50.next) {\n              case 0:\n              case \"end\":\n                return _context50.stop();\n            }\n          }\n        }, _callee50);\n      }));\n\n      function addProtectedRange() {\n        return _addProtectedRange.apply(this, arguments);\n      }\n\n      return addProtectedRange;\n    }()\n  }, {\n    key: \"updateProtectedRange\",\n    value: function () {\n      var _updateProtectedRange = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee51() {\n        return _regeneratorRuntime().wrap(function _callee51$(_context51) {\n          while (1) {\n            switch (_context51.prev = _context51.next) {\n              case 0:\n              case \"end\":\n                return _context51.stop();\n            }\n          }\n        }, _callee51);\n      }));\n\n      function updateProtectedRange() {\n        return _updateProtectedRange.apply(this, arguments);\n      }\n\n      return updateProtectedRange;\n    }()\n  }, {\n    key: \"deleteProtectedRange\",\n    value: function () {\n      var _deleteProtectedRange = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee52() {\n        return _regeneratorRuntime().wrap(function _callee52$(_context52) {\n          while (1) {\n            switch (_context52.prev = _context52.next) {\n              case 0:\n              case \"end\":\n                return _context52.stop();\n            }\n          }\n        }, _callee52);\n      }));\n\n      function deleteProtectedRange() {\n        return _deleteProtectedRange.apply(this, arguments);\n      }\n\n      return deleteProtectedRange;\n    }()\n  }, {\n    key: \"autoResizeDimensions\",\n    value: function () {\n      var _autoResizeDimensions = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee53() {\n        return _regeneratorRuntime().wrap(function _callee53$(_context53) {\n          while (1) {\n            switch (_context53.prev = _context53.next) {\n              case 0:\n              case \"end\":\n                return _context53.stop();\n            }\n          }\n        }, _callee53);\n      }));\n\n      function autoResizeDimensions() {\n        return _autoResizeDimensions.apply(this, arguments);\n      }\n\n      return autoResizeDimensions;\n    }()\n  }, {\n    key: \"addChart\",\n    value: function () {\n      var _addChart = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee54() {\n        return _regeneratorRuntime().wrap(function _callee54$(_context54) {\n          while (1) {\n            switch (_context54.prev = _context54.next) {\n              case 0:\n              case \"end\":\n                return _context54.stop();\n            }\n          }\n        }, _callee54);\n      }));\n\n      function addChart() {\n        return _addChart.apply(this, arguments);\n      }\n\n      return addChart;\n    }()\n  }, {\n    key: \"updateChartSpec\",\n    value: function () {\n      var _updateChartSpec = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee55() {\n        return _regeneratorRuntime().wrap(function _callee55$(_context55) {\n          while (1) {\n            switch (_context55.prev = _context55.next) {\n              case 0:\n              case \"end\":\n                return _context55.stop();\n            }\n          }\n        }, _callee55);\n      }));\n\n      function updateChartSpec() {\n        return _updateChartSpec.apply(this, arguments);\n      }\n\n      return updateChartSpec;\n    }()\n  }, {\n    key: \"updateBanding\",\n    value: function () {\n      var _updateBanding = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee56() {\n        return _regeneratorRuntime().wrap(function _callee56$(_context56) {\n          while (1) {\n            switch (_context56.prev = _context56.next) {\n              case 0:\n              case \"end\":\n                return _context56.stop();\n            }\n          }\n        }, _callee56);\n      }));\n\n      function updateBanding() {\n        return _updateBanding.apply(this, arguments);\n      }\n\n      return updateBanding;\n    }()\n  }, {\n    key: \"addBanding\",\n    value: function () {\n      var _addBanding = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee57() {\n        return _regeneratorRuntime().wrap(function _callee57$(_context57) {\n          while (1) {\n            switch (_context57.prev = _context57.next) {\n              case 0:\n              case \"end\":\n                return _context57.stop();\n            }\n          }\n        }, _callee57);\n      }));\n\n      function addBanding() {\n        return _addBanding.apply(this, arguments);\n      }\n\n      return addBanding;\n    }()\n  }, {\n    key: \"deleteBanding\",\n    value: function () {\n      var _deleteBanding = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee58() {\n        return _regeneratorRuntime().wrap(function _callee58$(_context58) {\n          while (1) {\n            switch (_context58.prev = _context58.next) {\n              case 0:\n              case \"end\":\n                return _context58.stop();\n            }\n          }\n        }, _callee58);\n      }));\n\n      function deleteBanding() {\n        return _deleteBanding.apply(this, arguments);\n      }\n\n      return deleteBanding;\n    }()\n  }, {\n    key: \"createDeveloperMetadata\",\n    value: function () {\n      var _createDeveloperMetadata = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee59() {\n        return _regeneratorRuntime().wrap(function _callee59$(_context59) {\n          while (1) {\n            switch (_context59.prev = _context59.next) {\n              case 0:\n              case \"end\":\n                return _context59.stop();\n            }\n          }\n        }, _callee59);\n      }));\n\n      function createDeveloperMetadata() {\n        return _createDeveloperMetadata.apply(this, arguments);\n      }\n\n      return createDeveloperMetadata;\n    }()\n  }, {\n    key: \"updateDeveloperMetadata\",\n    value: function () {\n      var _updateDeveloperMetadata = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee60() {\n        return _regeneratorRuntime().wrap(function _callee60$(_context60) {\n          while (1) {\n            switch (_context60.prev = _context60.next) {\n              case 0:\n              case \"end\":\n                return _context60.stop();\n            }\n          }\n        }, _callee60);\n      }));\n\n      function updateDeveloperMetadata() {\n        return _updateDeveloperMetadata.apply(this, arguments);\n      }\n\n      return updateDeveloperMetadata;\n    }()\n  }, {\n    key: \"deleteDeveloperMetadata\",\n    value: function () {\n      var _deleteDeveloperMetadata = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee61() {\n        return _regeneratorRuntime().wrap(function _callee61$(_context61) {\n          while (1) {\n            switch (_context61.prev = _context61.next) {\n              case 0:\n              case \"end\":\n                return _context61.stop();\n            }\n          }\n        }, _callee61);\n      }));\n\n      function deleteDeveloperMetadata() {\n        return _deleteDeveloperMetadata.apply(this, arguments);\n      }\n\n      return deleteDeveloperMetadata;\n    }()\n  }, {\n    key: \"randomizeRange\",\n    value: function () {\n      var _randomizeRange = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee62() {\n        return _regeneratorRuntime().wrap(function _callee62$(_context62) {\n          while (1) {\n            switch (_context62.prev = _context62.next) {\n              case 0:\n              case \"end\":\n                return _context62.stop();\n            }\n          }\n        }, _callee62);\n      }));\n\n      function randomizeRange() {\n        return _randomizeRange.apply(this, arguments);\n      }\n\n      return randomizeRange;\n    }()\n  }, {\n    key: \"addDimensionGroup\",\n    value: function () {\n      var _addDimensionGroup = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee63() {\n        return _regeneratorRuntime().wrap(function _callee63$(_context63) {\n          while (1) {\n            switch (_context63.prev = _context63.next) {\n              case 0:\n              case \"end\":\n                return _context63.stop();\n            }\n          }\n        }, _callee63);\n      }));\n\n      function addDimensionGroup() {\n        return _addDimensionGroup.apply(this, arguments);\n      }\n\n      return addDimensionGroup;\n    }()\n  }, {\n    key: \"deleteDimensionGroup\",\n    value: function () {\n      var _deleteDimensionGroup = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee64() {\n        return _regeneratorRuntime().wrap(function _callee64$(_context64) {\n          while (1) {\n            switch (_context64.prev = _context64.next) {\n              case 0:\n              case \"end\":\n                return _context64.stop();\n            }\n          }\n        }, _callee64);\n      }));\n\n      function deleteDimensionGroup() {\n        return _deleteDimensionGroup.apply(this, arguments);\n      }\n\n      return deleteDimensionGroup;\n    }()\n  }, {\n    key: \"updateDimensionGroup\",\n    value: function () {\n      var _updateDimensionGroup = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee65() {\n        return _regeneratorRuntime().wrap(function _callee65$(_context65) {\n          while (1) {\n            switch (_context65.prev = _context65.next) {\n              case 0:\n              case \"end\":\n                return _context65.stop();\n            }\n          }\n        }, _callee65);\n      }));\n\n      function updateDimensionGroup() {\n        return _updateDimensionGroup.apply(this, arguments);\n      }\n\n      return updateDimensionGroup;\n    }()\n  }, {\n    key: \"trimWhitespace\",\n    value: function () {\n      var _trimWhitespace = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee66() {\n        return _regeneratorRuntime().wrap(function _callee66$(_context66) {\n          while (1) {\n            switch (_context66.prev = _context66.next) {\n              case 0:\n              case \"end\":\n                return _context66.stop();\n            }\n          }\n        }, _callee66);\n      }));\n\n      function trimWhitespace() {\n        return _trimWhitespace.apply(this, arguments);\n      }\n\n      return trimWhitespace;\n    }()\n  }, {\n    key: \"deleteDuplicates\",\n    value: function () {\n      var _deleteDuplicates = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee67() {\n        return _regeneratorRuntime().wrap(function _callee67$(_context67) {\n          while (1) {\n            switch (_context67.prev = _context67.next) {\n              case 0:\n              case \"end\":\n                return _context67.stop();\n            }\n          }\n        }, _callee67);\n      }));\n\n      function deleteDuplicates() {\n        return _deleteDuplicates.apply(this, arguments);\n      }\n\n      return deleteDuplicates;\n    }()\n  }, {\n    key: \"addSlicer\",\n    value: function () {\n      var _addSlicer = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee68() {\n        return _regeneratorRuntime().wrap(function _callee68$(_context68) {\n          while (1) {\n            switch (_context68.prev = _context68.next) {\n              case 0:\n              case \"end\":\n                return _context68.stop();\n            }\n          }\n        }, _callee68);\n      }));\n\n      function addSlicer() {\n        return _addSlicer.apply(this, arguments);\n      }\n\n      return addSlicer;\n    }()\n  }, {\n    key: \"updateSlicerSpec\",\n    value: function () {\n      var _updateSlicerSpec = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee69() {\n        return _regeneratorRuntime().wrap(function _callee69$(_context69) {\n          while (1) {\n            switch (_context69.prev = _context69.next) {\n              case 0:\n              case \"end\":\n                return _context69.stop();\n            }\n          }\n        }, _callee69);\n      }));\n\n      function updateSlicerSpec() {\n        return _updateSlicerSpec.apply(this, arguments);\n      }\n\n      return updateSlicerSpec;\n    }() // delete this worksheet\n\n  }, {\n    key: \"delete\",\n    value: function () {\n      var _delete2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee70() {\n        return _regeneratorRuntime().wrap(function _callee70$(_context70) {\n          while (1) {\n            switch (_context70.prev = _context70.next) {\n              case 0:\n                return _context70.abrupt(\"return\", this._spreadsheet.deleteSheet(this.sheetId));\n\n              case 1:\n              case \"end\":\n                return _context70.stop();\n            }\n          }\n        }, _callee70, this);\n      }));\n\n      function _delete() {\n        return _delete2.apply(this, arguments);\n      }\n\n      return _delete;\n    }()\n  }, {\n    key: \"del\",\n    value: function () {\n      var _del = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee71() {\n        return _regeneratorRuntime().wrap(function _callee71$(_context71) {\n          while (1) {\n            switch (_context71.prev = _context71.next) {\n              case 0:\n                return _context71.abrupt(\"return\", this.delete());\n\n              case 1:\n              case \"end\":\n                return _context71.stop();\n            }\n          }\n        }, _callee71, this);\n      }));\n\n      function del() {\n        return _del.apply(this, arguments);\n      }\n\n      return del;\n    }() // alias to mimic old interface\n    // copies this worksheet into another document/spreadsheet\n\n  }, {\n    key: \"copyToSpreadsheet\",\n    value: function () {\n      var _copyToSpreadsheet = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee72(destinationSpreadsheetId) {\n        return _regeneratorRuntime().wrap(function _callee72$(_context72) {\n          while (1) {\n            switch (_context72.prev = _context72.next) {\n              case 0:\n                return _context72.abrupt(\"return\", this._spreadsheet.axios.post(\"/sheets/\".concat(this.sheetId, \":copyTo\"), {\n                  destinationSpreadsheetId: destinationSpreadsheetId\n                }));\n\n              case 1:\n              case \"end\":\n                return _context72.stop();\n            }\n          }\n        }, _callee72, this);\n      }));\n\n      function copyToSpreadsheet(_x23) {\n        return _copyToSpreadsheet.apply(this, arguments);\n      }\n\n      return copyToSpreadsheet;\n    }()\n  }, {\n    key: \"clear\",\n    value: function () {\n      var _clear = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee73(a1Range) {\n        var range;\n        return _regeneratorRuntime().wrap(function _callee73$(_context73) {\n          while (1) {\n            switch (_context73.prev = _context73.next) {\n              case 0:\n                // clears data in the sheet - defaults to entire sheet\n                range = a1Range ? \"!\".concat(a1Range) : ''; // sheet name without ie 'sheet1' rather than 'sheet1'!A1:B5 is all cells\n\n                _context73.next = 3;\n                return this._spreadsheet.axios.post(\"/values/\".concat(this.encodedA1SheetName).concat(range, \":clear\"));\n\n              case 3:\n                this.resetLocalCache(true);\n\n              case 4:\n              case \"end\":\n                return _context73.stop();\n            }\n          }\n        }, _callee73, this);\n      }));\n\n      function clear(_x24) {\n        return _clear.apply(this, arguments);\n      }\n\n      return clear;\n    }()\n  }, {\n    key: \"downloadAsCSV\",\n    value: function () {\n      var _downloadAsCSV = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee74() {\n        var returnStreamInsteadOfBuffer,\n            _args74 = arguments;\n        return _regeneratorRuntime().wrap(function _callee74$(_context74) {\n          while (1) {\n            switch (_context74.prev = _context74.next) {\n              case 0:\n                returnStreamInsteadOfBuffer = _args74.length > 0 && _args74[0] !== undefined ? _args74[0] : false;\n                return _context74.abrupt(\"return\", this._spreadsheet._downloadAs('csv', this.sheetId, returnStreamInsteadOfBuffer));\n\n              case 2:\n              case \"end\":\n                return _context74.stop();\n            }\n          }\n        }, _callee74, this);\n      }));\n\n      function downloadAsCSV() {\n        return _downloadAsCSV.apply(this, arguments);\n      }\n\n      return downloadAsCSV;\n    }()\n  }, {\n    key: \"downloadAsTSV\",\n    value: function () {\n      var _downloadAsTSV = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee75() {\n        var returnStreamInsteadOfBuffer,\n            _args75 = arguments;\n        return _regeneratorRuntime().wrap(function _callee75$(_context75) {\n          while (1) {\n            switch (_context75.prev = _context75.next) {\n              case 0:\n                returnStreamInsteadOfBuffer = _args75.length > 0 && _args75[0] !== undefined ? _args75[0] : false;\n                return _context75.abrupt(\"return\", this._spreadsheet._downloadAs('tsv', this.sheetId, returnStreamInsteadOfBuffer));\n\n              case 2:\n              case \"end\":\n                return _context75.stop();\n            }\n          }\n        }, _callee75, this);\n      }));\n\n      function downloadAsTSV() {\n        return _downloadAsTSV.apply(this, arguments);\n      }\n\n      return downloadAsTSV;\n    }()\n  }, {\n    key: \"downloadAsPDF\",\n    value: function () {\n      var _downloadAsPDF = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee76() {\n        var returnStreamInsteadOfBuffer,\n            _args76 = arguments;\n        return _regeneratorRuntime().wrap(function _callee76$(_context76) {\n          while (1) {\n            switch (_context76.prev = _context76.next) {\n              case 0:\n                returnStreamInsteadOfBuffer = _args76.length > 0 && _args76[0] !== undefined ? _args76[0] : false;\n                return _context76.abrupt(\"return\", this._spreadsheet._downloadAs('pdf', this.sheetId, returnStreamInsteadOfBuffer));\n\n              case 2:\n              case \"end\":\n                return _context76.stop();\n            }\n          }\n        }, _callee76, this);\n      }));\n\n      function downloadAsPDF() {\n        return _downloadAsPDF.apply(this, arguments);\n      }\n\n      return downloadAsPDF;\n    }()\n  }]);\n\n  return GoogleSpreadsheetWorksheet;\n}();\n\nmodule.exports = GoogleSpreadsheetWorksheet;","map":{"version":3,"names":["_","require","GoogleSpreadsheetRow","GoogleSpreadsheetCell","getFieldMask","columnToLetter","letterToColumn","checkForDuplicateHeaders","headers","checkForDupes","groupBy","each","grouped","header","length","Error","GoogleSpreadsheetWorksheet","parentSpreadsheet","properties","data","_spreadsheet","_headerRowIndex","_rawProperties","_cells","_rowMetadata","_columnMetadata","_fillCellData","requestType","requestParams","_makeSingleUpdateRequest","dataOnly","headerValues","dataRanges","range","startRow","startColumn","numRows","rowMetadata","numColumns","columnMetadata","i","actualRow","j","actualColumn","cellData","get","_updateRawData","param","_ensureInfoLoaded","newVal","_getProp","_setProp","gridProperties","rowCount","columnCount","title","replace","encodeURIComponent","a1SheetName","allCells","flatten","compact","nonEmpty","filter","c","value","loaded","total","a1Address","split","match","columnIndex","rowIndex","parseInt","getCell","sheetFilters","loadCells","filtersArray","isArray","map","isString","startsWith","isObject","sheetId","cellsToSave","_isDirty","saveCells","cellsToUpdate","requests","cell","_getUpdateRequest","responseRanges","_makeBatchUpdateRequest","headerRowIndex","undefined","getCellsInRange","lastColumnLetter","rows","trim","trimmedHeaderValues","h","axios","request","method","url","encodedA1SheetName","params","valueInputOption","includeValuesInResponse","majorDimension","values","times","response","updatedData","options","includes","loadHeaderRow","rowsAsArrays","row","rowAsArray","propName","push","raw","insertDataOption","insert","updatedRange","updates","rowNumber","rowValues","addRows","offset","limit","firstRow","lastRow","lastColumn","rawRows","rowNum","startRowIndex","start","endRowIndex","end","post","fields","updateProperties","updateGridProperties","columnsOrRows","bounds","dimension","startIndex","endIndex","a1Range","mergeType","sourceSheetId","index","insertSheetIndex","id","newSheetId","newSheetName","sheetsById","inheritFromBefore","isInteger","deleteSheet","delete","destinationSpreadsheetId","resetLocalCache","returnStreamInsteadOfBuffer","_downloadAs","module","exports"],"sources":["/Users/juliahindle/Documents/GitHub/ceramics/node_modules/google-spreadsheet/lib/GoogleSpreadsheetWorksheet.js"],"sourcesContent":["const _ = require('lodash');\n\nconst GoogleSpreadsheetRow = require('./GoogleSpreadsheetRow');\nconst GoogleSpreadsheetCell = require('./GoogleSpreadsheetCell');\n\nconst { getFieldMask, columnToLetter, letterToColumn } = require('./utils');\n\nfunction checkForDuplicateHeaders(headers) {\n  // check for duplicate headers\n  const checkForDupes = _.groupBy(headers); // { c1: ['c1'], c2: ['c2', 'c2' ]}\n  _.each(checkForDupes, (grouped, header) => {\n    if (!header) return; // empty columns are skipped, so multiple is ok\n    if (grouped.length > 1) {\n      throw new Error(`Duplicate header detected: \"${header}\". Please make sure all non-empty headers are unique`);\n    }\n  });\n}\n\nclass GoogleSpreadsheetWorksheet {\n  constructor(parentSpreadsheet, { properties, data }) {\n    this._spreadsheet = parentSpreadsheet; // the parent GoogleSpreadsheet instance\n\n    this._headerRowIndex = 1; // assume \"header row\" (for row-based calls) is in first row\n\n    // basic properties\n    this._rawProperties = properties;\n\n    this._cells = []; // we will use a 2d sparse array to store cells;\n\n    this._rowMetadata = []; // 1d sparse array\n    this._columnMetadata = [];\n\n    if (data) this._fillCellData(data);\n\n    return this;\n  }\n\n  // INTERNAL UTILITY FUNCTIONS ////////////////////////////////////////////////////////////////////\n  async _makeSingleUpdateRequest(requestType, requestParams) {\n    // pass the call up to the parent\n    return this._spreadsheet._makeSingleUpdateRequest(requestType, {\n      // sheetId: this.sheetId,\n      ...requestParams,\n    });\n  }\n\n  _ensureInfoLoaded() {\n    if (!this._rawProperties) {\n      throw new Error('You must call `doc.loadInfo()` again before accessing this property');\n    }\n  }\n\n  resetLocalCache(dataOnly) {\n    if (!dataOnly) this._rawProperties = null;\n    this.headerValues = null;\n    this._headerRowIndex = 1;\n    this._cells = [];\n  }\n\n  _fillCellData(dataRanges) {\n    _.each(dataRanges, (range) => {\n      const startRow = range.startRow || 0;\n      const startColumn = range.startColumn || 0;\n      const numRows = range.rowMetadata.length;\n      const numColumns = range.columnMetadata.length;\n\n      // update cell data for entire range\n      for (let i = 0; i < numRows; i++) {\n        const actualRow = startRow + i;\n        for (let j = 0; j < numColumns; j++) {\n          const actualColumn = startColumn + j;\n\n          // if the row has not been initialized yet, do it\n          if (!this._cells[actualRow]) this._cells[actualRow] = [];\n\n          // see if the response includes some info for the cell\n          const cellData = _.get(range, `rowData[${i}].values[${j}]`);\n\n          // update the cell object or create it\n          if (this._cells[actualRow][actualColumn]) {\n            this._cells[actualRow][actualColumn]._updateRawData(cellData);\n          } else {\n            this._cells[actualRow][actualColumn] = new GoogleSpreadsheetCell(\n              this,\n              actualRow,\n              actualColumn,\n              cellData\n            );\n          }\n        }\n      }\n\n      // update row metadata\n      for (let i = 0; i < range.rowMetadata.length; i++) {\n        this._rowMetadata[startRow + i] = range.rowMetadata[i];\n      }\n      // update column metadata\n      for (let i = 0; i < range.columnMetadata.length; i++) {\n        this._columnMetadata[startColumn + i] = range.columnMetadata[i];\n      }\n    });\n  }\n\n\n  // PROPERTY GETTERS //////////////////////////////////////////////////////////////////////////////\n  _getProp(param) {\n    this._ensureInfoLoaded();\n    return this._rawProperties[param];\n  }\n  _setProp(param, newVal) { // eslint-disable-line no-unused-vars\n    throw new Error('Do not update directly - use `updateProperties()`');\n  }\n\n  get sheetId() { return this._getProp('sheetId'); }\n  get title() { return this._getProp('title'); }\n  get index() { return this._getProp('index'); }\n  get sheetType() { return this._getProp('sheetType'); }\n  get gridProperties() { return this._getProp('gridProperties'); }\n  get hidden() { return this._getProp('hidden'); }\n  get tabColor() { return this._getProp('tabColor'); }\n  get rightToLeft() { return this._getProp('rightToLeft'); }\n\n  set sheetId(newVal) { return this._setProp('sheetId', newVal); }\n  set title(newVal) { return this._setProp('title', newVal); }\n  set index(newVal) { return this._setProp('index', newVal); }\n  set sheetType(newVal) { return this._setProp('sheetType', newVal); }\n  set gridProperties(newVal) { return this._setProp('gridProperties', newVal); }\n  set hidden(newVal) { return this._setProp('hidden', newVal); }\n  set tabColor(newVal) { return this._setProp('tabColor', newVal); }\n  set rightToLeft(newVal) { return this._setProp('rightToLeft', newVal); }\n\n  get rowCount() {\n    this._ensureInfoLoaded();\n    return this.gridProperties.rowCount;\n  }\n  get columnCount() {\n    this._ensureInfoLoaded();\n    return this.gridProperties.columnCount;\n  }\n  get colCount() { throw new Error('`colCount` is deprecated - please use `columnCount` instead.'); }\n  set rowCount(newVal) { throw new Error('Do not update directly. Use resize()'); }\n  set columnCount(newVal) { throw new Error('Do not update directly. Use resize()'); }\n\n  get a1SheetName() { return `'${this.title.replace(/'/g, \"''\")}'`; }\n  get encodedA1SheetName() { return encodeURIComponent(this.a1SheetName); }\n  get lastColumnLetter() { return columnToLetter(this.columnCount); }\n\n\n  // CELLS-BASED INTERACTIONS //////////////////////////////////////////////////////////////////////\n\n  get cellStats() {\n    let allCells = _.flatten(this._cells);\n    allCells = _.compact(allCells);\n    return {\n      nonEmpty: _.filter(allCells, (c) => c.value).length,\n      loaded: allCells.length,\n      total: this.rowCount * this.columnCount,\n    };\n  }\n\n  getCellByA1(a1Address) {\n    const split = a1Address.match(/([A-Z]+)([0-9]+)/);\n    const columnIndex = letterToColumn(split[1]);\n    const rowIndex = parseInt(split[2]);\n    return this.getCell(rowIndex - 1, columnIndex - 1);\n  }\n\n  getCell(rowIndex, columnIndex) {\n    if (rowIndex < 0 || columnIndex < 0) throw new Error('Min coordinate is 0, 0');\n    if (rowIndex >= this.rowCount || columnIndex >= this.columnCount) {\n      throw new Error(`Out of bounds, sheet is ${this.rowCount} by ${this.columnCount}`);\n    }\n\n    if (!_.get(this._cells, `[${rowIndex}][${columnIndex}]`)) {\n      throw new Error('This cell has not been loaded yet');\n    }\n    return this._cells[rowIndex][columnIndex];\n  }\n\n  async loadCells(sheetFilters) {\n    // load the whole sheet\n    if (!sheetFilters) return this._spreadsheet.loadCells(this.a1SheetName);\n\n    let filtersArray = _.isArray(sheetFilters) ? sheetFilters : [sheetFilters];\n    filtersArray = _.map(filtersArray, (filter) => {\n      // add sheet name to A1 ranges\n      if (_.isString(filter)) {\n        if (filter.startsWith(this.a1SheetName)) return filter;\n        return `${this.a1SheetName}!${filter}`;\n      }\n      if (_.isObject(filter)) {\n        // TODO: detect and support DeveloperMetadata filters\n        if (!filter.sheetId) {\n          return { sheetId: this.sheetId, ...filter };\n        }\n        if (filter.sheetId !== this.sheetId) {\n          throw new Error('Leave sheet ID blank or set to matching ID of this sheet');\n        } else {\n          return filter;\n        }\n      } else {\n        throw new Error('Each filter must be a A1 range string or gridrange object');\n      }\n    });\n    return this._spreadsheet.loadCells(filtersArray);\n  }\n\n  async saveUpdatedCells() {\n    const cellsToSave = _.filter(_.flatten(this._cells), { _isDirty: true });\n    if (cellsToSave.length) {\n      await this.saveCells(cellsToSave);\n    }\n    // TODO: do we want to return stats? or the cells that got updated?\n  }\n\n  async saveCells(cellsToUpdate) {\n    // we send an individual \"updateCells\" request for each cell\n    // because the fields that are udpated for each group are the same\n    // and we dont want to accidentally overwrite something\n    const requests = _.map(cellsToUpdate, (cell) => cell._getUpdateRequest());\n    const responseRanges = _.map(cellsToUpdate, (c) => `${this.a1SheetName}!${c.a1Address}`);\n\n    // if nothing is being updated the request returned is just `null`\n    // so we make sure at least 1 request is valid - otherwise google throws a 400\n    if (!_.compact(requests).length) {\n      throw new Error('At least one cell must have something to update');\n    }\n\n    await this._spreadsheet._makeBatchUpdateRequest(requests, responseRanges);\n  }\n\n  // SAVING THIS FOR FUTURE USE\n  // puts the cells that need updating into batches\n  // async updateCellsByBatches() {\n  //   // saving this code, but it's problematic because each group must have the same update fields\n  //   const cellsByRow = _.groupBy(cellsToUpdate, 'rowIndex');\n  //   const groupsToSave = [];\n  //   _.each(cellsByRow, (cells, rowIndex) => {\n  //     let cellGroup = [];\n  //     _.each(cells, (c) => {\n  //       if (!cellGroup.length) {\n  //         cellGroup.push(c);\n  //       } else if (\n  //         cellGroup[cellGroup.length - 1].columnIndex ===\n  //         c.columnIndex - 1\n  //       ) {\n  //         cellGroup.push(c);\n  //       } else {\n  //         groupsToSave.push(cellGroup);\n  //         cellGroup = [];\n  //       }\n  //     });\n  //     groupsToSave.push(cellGroup);\n  //   });\n  //   const requests = _.map(groupsToSave, (cellGroup) => ({\n  //     updateCells: {\n  //       rows: [\n  //         {\n  //           values: _.map(cellGroup, (cell) => ({\n  //             ...cell._draftData.value && {\n  //               userEnteredValue: { [cell._draftData.valueType]: cell._draftData.value },\n  //             },\n  //             ...cell._draftData.note !== undefined && {\n  //               note: cell._draftData.note ,\n  //             },\n  //             ...cell._draftData.userEnteredFormat && {\n  //               userEnteredValue: cell._draftData.userEnteredFormat,\n  //             },\n  //           })),\n  //         },\n  //       ],\n  //       fields: 'userEnteredValue,note,userEnteredFormat',\n  //       start: {\n  //         sheetId: this.sheetId,\n  //         rowIndex: cellGroup[0].rowIndex,\n  //         columnIndex: cellGroup[0].columnIndex,\n  //       },\n  //     },\n  //   }));\n  //   const responseRanges = _.map(groupsToSave, (cellGroup) => {\n  //     let a1Range = cellGroup[0].a1Address;\n  //     if (cellGroup.length > 1)\n  //       a1Range += `:${cellGroup[cellGroup.length - 1].a1Address}`;\n  //     return `${cellGroup[0]._sheet.a1SheetName}!${a1Range}`;\n  //   });\n  // }\n\n  // ROW BASED FUNCTIONS ///////////////////////////////////////////////////////////////////////////\n\n  async loadHeaderRow(headerRowIndex) {\n    if (headerRowIndex !== undefined) this._headerRowIndex = headerRowIndex;\n    const rows = await this.getCellsInRange(`A${this._headerRowIndex}:${this.lastColumnLetter}${this._headerRowIndex}`);\n    if (!rows) {\n      throw new Error('No values in the header row - fill the first row with header values before trying to interact with rows');\n    }\n    this.headerValues = _.map(rows[0], (header) => header.trim());\n    if (!_.compact(this.headerValues).length) {\n      throw new Error('All your header cells are blank - fill the first row with header values before trying to interact with rows');\n    }\n    checkForDuplicateHeaders(this.headerValues);\n  }\n\n  async setHeaderRow(headerValues, headerRowIndex) {\n    if (!headerValues) return;\n    if (headerValues.length > this.columnCount) {\n      throw new Error(`Sheet is not large enough to fit ${headerValues.length} columns. Resize the sheet first.`);\n    }\n    const trimmedHeaderValues = _.map(headerValues, (h) => h.trim());\n    checkForDuplicateHeaders(trimmedHeaderValues);\n\n    if (!_.compact(trimmedHeaderValues).length) {\n      throw new Error('All your header cells are blank -');\n    }\n\n    if (headerRowIndex) this._headerRowIndex = headerRowIndex;\n\n    const response = await this._spreadsheet.axios.request({\n      method: 'put',\n      url: `/values/${this.encodedA1SheetName}!${this._headerRowIndex}:${this._headerRowIndex}`,\n      params: {\n        valueInputOption: 'USER_ENTERED', // other option is RAW\n        includeValuesInResponse: true,\n      },\n      data: {\n        range: `${this.a1SheetName}!${this._headerRowIndex}:${this._headerRowIndex}`,\n        majorDimension: 'ROWS',\n        values: [[\n          ...trimmedHeaderValues,\n          // pad the rest of the row with empty values to clear them all out\n          ..._.times(this.columnCount - trimmedHeaderValues.length, () => ''),\n        ]],\n      },\n    });\n    this.headerValues = response.data.updatedData.values[0];\n  }\n\n  async addRows(rows, options = {}) {\n    // adds multiple rows in one API interaction using the append endpoint\n\n    // each row can be an array or object\n    // an array is just cells\n    // ex: ['column 1', 'column 2', 'column 3']\n    // an object must use the header row values as keys\n    // ex: { col1: 'column 1', col2: 'column 2', col3: 'column 3' }\n\n    // google bug that does not handle colons in names\n    // see https://issuetracker.google.com/issues/150373119\n    if (this.title.includes(':')) {\n      throw new Error('Please remove the \":\" from your sheet title. There is a bug with the google API which breaks appending rows if any colons are in the sheet title.');\n    }\n\n    if (!_.isArray(rows)) throw new Error('You must pass in an array of row values to append');\n\n    if (!this.headerValues) await this.loadHeaderRow();\n\n    // convert each row into an array of cell values rather than the key/value object\n    const rowsAsArrays = [];\n    _.each(rows, (row) => {\n      let rowAsArray;\n      if (_.isArray(row)) {\n        rowAsArray = row;\n      } else if (_.isObject(row)) {\n        rowAsArray = [];\n        for (let i = 0; i < this.headerValues.length; i++) {\n          const propName = this.headerValues[i];\n          rowAsArray[i] = row[propName];\n        }\n      } else {\n        throw new Error('Each row must be an object or an array');\n      }\n      rowsAsArrays.push(rowAsArray);\n    });\n\n    const response = await this._spreadsheet.axios.request({\n      method: 'post',\n      url: `/values/${this.encodedA1SheetName}!A${this._headerRowIndex}:append`,\n      params: {\n        valueInputOption: options.raw ? 'RAW' : 'USER_ENTERED',\n        insertDataOption: options.insert ? 'INSERT_ROWS' : 'OVERWRITE',\n        includeValuesInResponse: true,\n      },\n      data: {\n        values: rowsAsArrays,\n      },\n    });\n\n    // extract the new row number from the A1-notation data range in the response\n    // ex: in \"'Sheet8!A2:C2\" -- we want the `2`\n    const { updatedRange } = response.data.updates;\n    let rowNumber = updatedRange.match(/![A-Z]+([0-9]+):?/)[1];\n    rowNumber = parseInt(rowNumber);\n\n    // if new rows were added, we need update sheet.rowRount\n    if (options.insert) {\n      this._rawProperties.gridProperties.rowCount += rows.length;\n    } else if (rowNumber + rows.length > this.rowCount) {\n      // have to subtract 1 since one row was inserted at rowNumber\n      this._rawProperties.gridProperties.rowCount = rowNumber + rows.length - 1;\n    }\n\n    return _.map(response.data.updates.updatedData.values, (rowValues) => {\n      const row = new GoogleSpreadsheetRow(this, rowNumber++, rowValues);\n      return row;\n    });\n  }\n\n  async addRow(rowValues, options) {\n    const rows = await this.addRows([rowValues], options);\n    return rows[0];\n  }\n\n  async getRows(options = {}) {\n    // https://developers.google.com/sheets/api/guides/migration\n    // v4 API does not have equivalents for the row-order query parameters provided\n    // Reverse-order is trivial; simply process the returned values array in reverse order.\n    // Order by column is not supported for reads, but it is possible to sort the data then read\n\n    // v4 API does not currently have a direct equivalent for the Sheets API v3 structured queries\n    // However, you can retrieve the relevant data and sort through it as needed in your application\n\n    // options\n    // - offset\n    // - limit\n\n    options.offset = options.offset || 0;\n    options.limit = options.limit || this.rowCount - 1;\n\n    if (!this.headerValues) await this.loadHeaderRow();\n\n    const firstRow = 1 + this._headerRowIndex + options.offset;\n    const lastRow = firstRow + options.limit - 1; // inclusive so we subtract 1\n    const lastColumn = columnToLetter(this.headerValues.length);\n    const rawRows = await this.getCellsInRange(\n      `A${firstRow}:${lastColumn}${lastRow}`\n    );\n\n    if (!rawRows) return [];\n\n    const rows = [];\n    let rowNum = firstRow;\n    for (let i = 0; i < rawRows.length; i++) {\n      rows.push(new GoogleSpreadsheetRow(this, rowNum++, rawRows[i]));\n    }\n    return rows;\n  }\n\n  async clearRows(options = {}) {\n    // default to first row after header\n    const startRowIndex = options.start || this._headerRowIndex + 1;\n    const endRowIndex = options.end || this.rowCount;\n    await this._spreadsheet.axios.post(`/values/${this.encodedA1SheetName}!${startRowIndex}:${endRowIndex}:clear`);\n  }\n\n  // BASIC PROPS ///////////////////////////////////////////////////////////////////////////////////\n  async updateProperties(properties) {\n    // Request type = `updateSheetProperties`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#UpdateSheetPropertiesRequest\n\n    // properties\n    // - title (string)\n    // - index (number)\n    // - gridProperties ({ object (GridProperties) } - https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/sheets#gridproperties\n    // - hidden (boolean)\n    // - tabColor ({ object (Color) } - https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/other#Color\n    // - rightToLeft (boolean)\n\n    return this._makeSingleUpdateRequest('updateSheetProperties', {\n      properties: {\n        sheetId: this.sheetId,\n        ...properties,\n      },\n      fields: getFieldMask(properties),\n    });\n  }\n\n  async updateGridProperties(gridProperties) {\n    // just passes the call through to update gridProperties\n    // see https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/sheets#GridProperties\n\n    // gridProperties\n    // - rowCount\n    // - columnCount\n    // - frozenRowCount\n    // - frozenColumnCount\n    // - hideGridLines\n    return this.updateProperties({ gridProperties });\n  }\n\n  // just a shortcut because resize makes more sense to change rowCount / columnCount\n  async resize(gridProperties) {\n    return this.updateGridProperties(gridProperties);\n  }\n\n  async updateDimensionProperties(columnsOrRows, properties, bounds) {\n    // Request type = `updateDimensionProperties`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#updatedimensionpropertiesrequest\n\n    // columnsOrRows = COLUMNS|ROWS\n    // properties\n    // - pixelSize\n    // - hiddenByUser\n    // - developerMetadata\n    // bounds\n    // - startIndex\n    // - endIndex\n\n    return this._makeSingleUpdateRequest('updateDimensionProperties', {\n      range: {\n        sheetId: this.sheetId,\n        dimension: columnsOrRows,\n        ...bounds && {\n          startIndex: bounds.startIndex,\n          endIndex: bounds.endIndex,\n        },\n      },\n      properties,\n      fields: getFieldMask(properties),\n    });\n  }\n\n  // OTHER /////////////////////////////////////////////////////////////////////////////////////////\n\n  // this uses the \"values\" getter and does not give all the info about the cell contents\n  // it is used internally when loading header cells\n  async getCellsInRange(a1Range, options) {\n    const response = await this._spreadsheet.axios.get(`/values/${this.encodedA1SheetName}!${a1Range}`, {\n      params: options,\n    });\n    return response.data.values;\n  }\n\n  async updateNamedRange() {\n    // Request type = `updateNamedRange`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#UpdateNamedRangeRequest\n  }\n\n  async addNamedRange() {\n    // Request type = `addNamedRange`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#AddNamedRangeRequest\n  }\n\n  async deleteNamedRange() {\n    // Request type = `deleteNamedRange`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#DeleteNamedRangeRequest\n  }\n\n  async repeatCell() {\n    // Request type = `repeatCell`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#RepeatCellRequest\n  }\n\n  async autoFill() {\n    // Request type = `autoFill`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#AutoFillRequest\n  }\n\n  async cutPaste() {\n    // Request type = `cutPaste`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#CutPasteRequest\n  }\n\n  async copyPaste() {\n    // Request type = `copyPaste`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#CopyPasteRequest\n  }\n\n  async mergeCells(range, mergeType = 'MERGE_ALL') {\n    // Request type = `mergeCells`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#MergeCellsRequest\n    if (range.sheetId && range.sheetId !== this.sheetId) {\n      throw new Error('Leave sheet ID blank or set to matching ID of this sheet');\n    }\n    await this._makeSingleUpdateRequest('mergeCells', {\n      mergeType,\n      range: {\n        ...range,\n        sheetId: this.sheetId,\n      },\n    });\n  }\n\n  async unmergeCells(range) {\n    // Request type = `unmergeCells`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#UnmergeCellsRequest\n    if (range.sheetId && range.sheetId !== this.sheetId) {\n      throw new Error('Leave sheet ID blank or set to matching ID of this sheet');\n    }\n    await this._makeSingleUpdateRequest('unmergeCells', {\n      range: {\n        ...range,\n        sheetId: this.sheetId,\n      },\n    });\n  }\n\n  async updateBorders() {\n    // Request type = `updateBorders`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#UpdateBordersRequest\n  }\n\n  async addFilterView() {\n    // Request type = `addFilterView`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#AddFilterViewRequest\n  }\n\n  async appendCells() {\n    // Request type = `appendCells`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#AppendCellsRequest\n  }\n\n  async clearBasicFilter() {\n    // Request type = `clearBasicFilter`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#ClearBasicFilterRequest\n  }\n\n  async deleteDimension() {\n    // Request type = `deleteDimension`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#DeleteDimensionRequest\n  }\n\n  async deleteEmbeddedObject() {\n    // Request type = `deleteEmbeddedObject`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#DeleteEmbeddedObjectRequest\n  }\n\n  async deleteFilterView() {\n    // Request type = `deleteFilterView`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#DeleteFilterViewRequest\n  }\n\n  async duplicateFilterView() {\n    // Request type = `duplicateFilterView`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#DuplicateFilterViewRequest\n  }\n\n  async duplicate(options = {}) {\n    // Request type = `duplicateSheet`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#DuplicateSheetRequest\n    const response = await this._makeSingleUpdateRequest('duplicateSheet', {\n      sourceSheetId: this.sheetId,\n      ...options.index !== undefined && { insertSheetIndex: options.index },\n      ...options.id && { newSheetId: options.id },\n      ...options.title && { newSheetName: options.title },\n    });\n    const newSheetId = response.properties.sheetId;\n    return this._spreadsheet.sheetsById[newSheetId];\n  }\n\n  async findReplace() {\n    // Request type = `findReplace`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#FindReplaceRequest\n  }\n\n  async insertDimension(columnsOrRows, range, inheritFromBefore = null) {\n    // Request type = `insertDimension`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#InsertDimensionRequest\n\n    if (!columnsOrRows) throw new Error('You need to specify a dimension. i.e. COLUMNS|ROWS');\n    if (!_.isObject(range)) throw new Error('`range` must be an object containing `startIndex` and `endIndex`');\n    if (!_.isInteger(range.startIndex) || range.startIndex < 0) throw new Error('range.startIndex must be an integer >=0');\n    if (!_.isInteger(range.endIndex) || range.endIndex < 0) throw new Error('range.endIndex must be an integer >=0');\n    if (range.endIndex <= range.startIndex) throw new Error('range.endIndex must be greater than range.startIndex');\n\n    // default inheritFromBefore to true - unless inserting in the first row/column\n    if (inheritFromBefore === null) {\n      inheritFromBefore = range.startIndex > 0;\n    }\n\n    // do not allow inheritFromBefore if inserting at first row/column\n    if (inheritFromBefore && range.startIndex === 0) {\n      throw new Error('Cannot set inheritFromBefore to true if inserting in first row/column');\n    }\n\n    return this._makeSingleUpdateRequest('insertDimension', {\n      range: {\n        sheetId: this.sheetId,\n        dimension: columnsOrRows,\n        startIndex: range.startIndex,\n        endIndex: range.endIndex,\n      },\n      inheritFromBefore,\n    });\n  }\n\n  async insertRange() {\n    // Request type = `insertRange`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#InsertRangeRequest\n  }\n\n  async moveDimension() {\n    // Request type = `moveDimension`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#MoveDimensionRequest\n  }\n\n  async updateEmbeddedObjectPosition() {\n    // Request type = `updateEmbeddedObjectPosition`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#UpdateEmbeddedObjectPositionRequest\n  }\n\n  async pasteData() {\n    // Request type = `pasteData`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#PasteDataRequest\n  }\n\n  async textToColumns() {\n    // Request type = `textToColumns`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#TextToColumnsRequest\n  }\n\n  async updateFilterView() {\n    // Request type = `updateFilterView`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#UpdateFilterViewRequest\n  }\n\n  async deleteRange() {\n    // Request type = `deleteRange`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#DeleteRangeRequest\n  }\n\n  async appendDimension() {\n    // Request type = `appendDimension`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#AppendDimensionRequest\n  }\n\n  async addConditionalFormatRule() {\n    // Request type = `addConditionalFormatRule`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#AddConditionalFormatRuleRequest\n  }\n\n  async updateConditionalFormatRule() {\n    // Request type = `updateConditionalFormatRule`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#UpdateConditionalFormatRuleRequest\n  }\n\n  async deleteConditionalFormatRule() {\n    // Request type = `deleteConditionalFormatRule`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#DeleteConditionalFormatRuleRequest\n  }\n\n  async sortRange() {\n    // Request type = `sortRange`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#SortRangeRequest\n  }\n\n  async setDataValidation() {\n    // Request type = `setDataValidation`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#SetDataValidationRequest\n  }\n\n  async setBasicFilter() {\n    // Request type = `setBasicFilter`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#SetBasicFilterRequest\n  }\n\n  async addProtectedRange() {\n    // Request type = `addProtectedRange`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#AddProtectedRangeRequest\n  }\n\n  async updateProtectedRange() {\n    // Request type = `updateProtectedRange`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#UpdateProtectedRangeRequest\n  }\n\n  async deleteProtectedRange() {\n    // Request type = `deleteProtectedRange`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#DeleteProtectedRangeRequest\n  }\n\n  async autoResizeDimensions() {\n    // Request type = `autoResizeDimensions`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#AutoResizeDimensionsRequest\n  }\n\n  async addChart() {\n    // Request type = `addChart`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#AddChartRequest\n  }\n\n  async updateChartSpec() {\n    // Request type = `updateChartSpec`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#UpdateChartSpecRequest\n  }\n\n  async updateBanding() {\n    // Request type = `updateBanding`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#UpdateBandingRequest\n  }\n\n  async addBanding() {\n    // Request type = `addBanding`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#AddBandingRequest\n  }\n\n  async deleteBanding() {\n    // Request type = `deleteBanding`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#DeleteBandingRequest\n  }\n\n  async createDeveloperMetadata() {\n    // Request type = `createDeveloperMetadata`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#CreateDeveloperMetadataRequest\n  }\n\n  async updateDeveloperMetadata() {\n    // Request type = `updateDeveloperMetadata`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#UpdateDeveloperMetadataRequest\n  }\n\n  async deleteDeveloperMetadata() {\n    // Request type = `deleteDeveloperMetadata`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#DeleteDeveloperMetadataRequest\n  }\n\n  async randomizeRange() {\n    // Request type = `randomizeRange`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#RandomizeRangeRequest\n  }\n\n  async addDimensionGroup() {\n    // Request type = `addDimensionGroup`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#AddDimensionGroupRequest\n  }\n\n  async deleteDimensionGroup() {\n    // Request type = `deleteDimensionGroup`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#DeleteDimensionGroupRequest\n  }\n\n  async updateDimensionGroup() {\n    // Request type = `updateDimensionGroup`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#UpdateDimensionGroupRequest\n  }\n\n  async trimWhitespace() {\n    // Request type = `trimWhitespace`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#TrimWhitespaceRequest\n  }\n\n  async deleteDuplicates() {\n    // Request type = `deleteDuplicates`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#DeleteDuplicatesRequest\n  }\n\n  async addSlicer() {\n    // Request type = `addSlicer`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#AddSlicerRequest\n  }\n\n  async updateSlicerSpec() {\n    // Request type = `updateSlicerSpec`\n    // https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/request#UpdateSlicerSpecRequest\n  }\n\n  // delete this worksheet\n  async delete() {\n    return this._spreadsheet.deleteSheet(this.sheetId);\n  }\n  async del() { return this.delete(); } // alias to mimic old interface\n\n  // copies this worksheet into another document/spreadsheet\n  async copyToSpreadsheet(destinationSpreadsheetId) {\n    return this._spreadsheet.axios.post(`/sheets/${this.sheetId}:copyTo`, {\n      destinationSpreadsheetId,\n    });\n  }\n\n  async clear(a1Range) {\n    // clears data in the sheet - defaults to entire sheet\n    const range = a1Range ? `!${a1Range}` : '';\n    // sheet name without ie 'sheet1' rather than 'sheet1'!A1:B5 is all cells\n    await this._spreadsheet.axios.post(`/values/${this.encodedA1SheetName}${range}:clear`);\n    this.resetLocalCache(true);\n  }\n  async downloadAsCSV(returnStreamInsteadOfBuffer = false) {\n    return this._spreadsheet._downloadAs('csv', this.sheetId, returnStreamInsteadOfBuffer);\n  }\n  async downloadAsTSV(returnStreamInsteadOfBuffer = false) {\n    return this._spreadsheet._downloadAs('tsv', this.sheetId, returnStreamInsteadOfBuffer);\n  }\n  async downloadAsPDF(returnStreamInsteadOfBuffer = false) {\n    return this._spreadsheet._downloadAs('pdf', this.sheetId, returnStreamInsteadOfBuffer);\n  }\n}\n\nmodule.exports = GoogleSpreadsheetWorksheet;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}